{
	"info": {
		"_postman_id": "abai-springs-api-collection",
		"name": "Abai Springs Web App API",
		"description": "Complete API collection for Abai Springs Web App with authentication, products, orders, payments, analytics, and logs endpoints.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "abai-springs"
	},
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Register User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"john@example.com\",\n  \"phone\": \"+254700000000\",\n  \"password\": \"SecurePassword123!\",\n  \"role\": \"customer\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/register",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"register"
							]
						}
					},
					"response": []
				},
				{
					"name": "Login User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"john@example.com\",\n  \"password\": \"SecurePassword123!\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "Refresh Token",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"refreshToken\": \"{{refresh_token}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/refresh",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"refresh"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Current User",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/auth/me",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"me"
							]
						}
					},
					"response": []
				},
				{
					"name": "Logout",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/auth/logout",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"logout"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Products",
			"item": [
				{
					"name": "Get All Products",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/products?page=1&limit=10",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"products"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "limit",
									"value": "10"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Product by ID",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/products/{{product_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"products",
								"{{product_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create Product (Admin)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"New Product\",\n  \"brand\": \"Abai Springs\",\n  \"category\": \"Water\",\n  \"description\": \"Product description\",\n  \"price\": 100,\n  \"stockLevel\": 50,\n  \"image\": \"product.png\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/products",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"products"
							]
						}
					},
					"response": []
				},
				{
					"name": "Update Product (Admin)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Updated Product\",\n  \"brand\": \"Abai Springs\",\n  \"category\": \"Water\",\n  \"description\": \"Updated description\",\n  \"price\": 120,\n  \"stockLevel\": 60,\n  \"image\": \"updated-product.png\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/products/{{product_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"products",
								"{{product_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete Product (Admin)",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/products/{{product_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"products",
								"{{product_id}}"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Outlets",
			"item": [
				{
					"name": "Get All Outlets",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/outlets?page=1&limit=10",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"outlets"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "limit",
									"value": "10"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Outlet by ID",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/outlets/{{outlet_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"outlets",
								"{{outlet_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create Outlet (Admin)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"New Outlet\",\n  \"address\": \"Address, City\",\n  \"phone\": \"+254700000000\",\n  \"email\": \"outlet@abaisprings.com\",\n  \"coordinates\": {\n    \"lat\": -1.2921,\n    \"lng\": 36.8219\n  },\n  \"features\": [\"delivery\", \"pickup\"]\n}"
						},
						"url": {
							"raw": "{{base_url}}/outlets",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"outlets"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Orders",
			"item": [
				{
					"name": "Get All Orders",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/orders?page=1&limit=10",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"orders"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "limit",
									"value": "10"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Order by ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/orders/{{order_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"orders",
								"{{order_id}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create Order",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"outletId\": \"{{outlet_id}}\",\n  \"items\": [\n    {\n      \"productId\": \"{{product_id}}\",\n      \"quantity\": 2\n    }\n  ],\n  \"deliveryAddress\": \"123 Main St, Nairobi\",\n  \"deliveryInstructions\": \"Leave at gate\",\n  \"paymentMethod\": \"mpesa\",\n  \"paymentTiming\": \"pay_now\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/orders",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"orders"
							]
						}
					},
					"response": []
				},
				{
					"name": "Update Order Status (Admin)",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"status\": \"processing\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/orders/{{order_id}}/status",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"orders",
								"{{order_id}}",
								"status"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Payments",
			"item": [
				{
					"name": "Process Payment",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"orderId\": \"{{order_id}}\",\n  \"paymentMethod\": \"mpesa\",\n  \"phoneNumber\": \"+254700000000\",\n  \"amount\": 100\n}"
						},
						"url": {
							"raw": "{{base_url}}/payments/process",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"payments",
								"process"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Payment Status",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/payments/{{payment_id}}/status",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"payments",
								"{{payment_id}}",
								"status"
							]
						}
					},
					"response": []
				},
				{
					"name": "M-Pesa Callback",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-MPESA-Signature",
								"value": "{{webhook_signature}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"CheckoutRequestID\": \"{{checkout_request_id}}\",\n  \"ResultCode\": 0,\n  \"ResultDesc\": \"Success\",\n  \"Amount\": 100,\n  \"MpesaReceiptNumber\": \"{{receipt_number}}\",\n  \"TransactionDate\": \"20240115103500\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/payments/mpesa/callback",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"payments",
								"mpesa",
								"callback"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Analytics",
			"item": [
				{
					"name": "Get Dashboard Analytics",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/analytics/dashboard?period=monthly",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"analytics",
								"dashboard"
							],
							"query": [
								{
									"key": "period",
									"value": "monthly"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Revenue Analytics",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/analytics/revenue",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"analytics",
								"revenue"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Sales Analytics",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/analytics/sales",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"analytics",
								"sales"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Product Analytics",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/analytics/products",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"analytics",
								"products"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Logs",
			"item": [
				{
					"name": "Get Log Statistics",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/logs/stats",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"logs",
								"stats"
							]
						}
					},
					"response": []
				},
				{
					"name": "Search Logs",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/logs/search?level=error&limit=50",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"logs",
								"search"
							],
							"query": [
								{
									"key": "level",
									"value": "error"
								},
								{
									"key": "limit",
									"value": "50"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Error Logs",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/logs/errors",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"logs",
								"errors"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Security Logs",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/logs/security",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"logs",
								"security"
							]
						}
					},
					"response": []
				},
				{
					"name": "Export Logs",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{admin_access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"startDate\": \"2024-01-01\",\n  \"endDate\": \"2024-01-15\",\n  \"level\": \"error\",\n  \"format\": \"json\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/logs/export",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"logs",
								"export"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Auto-set access token from login response",
					"if (pm.response && pm.response.json() && pm.response.json().data && pm.response.json().data.tokens) {",
					"    pm.environment.set('access_token', pm.response.json().data.tokens.accessToken);",
					"    pm.environment.set('refresh_token', pm.response.json().data.tokens.refreshToken);",
					"}",
					"",
					"// Auto-set admin token if role is admin",
					"if (pm.response && pm.response.json() && pm.response.json().data && pm.response.json().data.user && pm.response.json().data.user.role === 'admin') {",
					"    pm.environment.set('admin_access_token', pm.response.json().data.tokens.accessToken);",
					"}"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:3001/api",
			"type": "string"
		},
		{
			"key": "access_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "refresh_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "admin_access_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "product_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "outlet_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "order_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "payment_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "checkout_request_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "receipt_number",
			"value": "",
			"type": "string"
		},
		{
			"key": "webhook_signature",
			"value": "",
			"type": "string"
		}
	]
}
